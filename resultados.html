<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Resultados — TuneMyTrip</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Open+Sans&display=swap');
  body {
    margin: 0;
    min-height: 100vh;
    background-color: #0f1e33;
    font-family: 'Open Sans', Arial, sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0 8px 36px 8px;
  }
  header {
    width: 100%;
    max-width: 360px;
    text-align: center;
    margin: 32px 0 16px 0;
  }
  header img {
    max-width: 250px;
    height: auto;
    filter: drop-shadow(0 0 8px rgba(0,198,255,0.8));
    display: inline-block;
  }
  main {
    width: 100%;
    max-width: 650px;
    padding: 20px 0 0 0;
  }
  h1 {
    text-align: center;
    color: #00c6ff;
    font-size: 1.29rem;
    margin: 0 0 20px 0;
    font-weight: 700;
    letter-spacing: 1.7px;
    text-shadow: 0 0 14px #0fd6fd44;
    padding-top: 2px;
  }
  #results-container {
    background: rgba(0,0,0,0.81);
    border-radius: 13px;
    padding: 28px 22px;
    box-shadow: 0 7px 28px #00c6ff25;
    margin-bottom: 18px;
    min-height: 90px;
    font-size: 1rem;
  }
  .section-title {
    color: #00aaff;
    margin: 23px 0 13px 0;
    font-size: 1.05rem;
    font-weight: bold;
    border-bottom: 1.5px solid #00aaff62;
    padding-bottom: 5px;
    letter-spacing: 1px;
    text-align: left;
  }
  .result-item {
    border-bottom: 1px solid #00c6ff77;
    margin-bottom: 15px;
    padding-bottom: 10px;
    word-break: break-word;
    font-size: 0.99rem;
    padding-left: 4px;
  }
  .result-item:last-child {
    border-bottom: none;
  }
  .empty-result {
    text-align: center;
    color: #fff9;
    font-style: italic;
    margin: 58px 0 34px 0;
    font-size: 1rem;
  }
  .back-link {
    display: inline-block;
    margin: 22px auto 0 auto;
    padding: 11px 25px;
    background: #0077cc;
    color: #fff;
    text-decoration: none;
    border-radius: 9px;
    font-weight: bold;
    font-size: 1.02rem;
    box-shadow: 0 4px 16px #00c6ff2a;
    transition: background 0.27s;
    text-align: center;
    cursor: pointer;
  }
  .back-link:hover,
  .back-link:focus {
    background: #00c6ff;
    outline: none;
    color: #031d3b;
  }
  @media (max-width: 520px) {
    #results-container, main { padding-left: 0; padding-right: 0; }
    header img { max-width: 85vw;}
  }
</style>
</head>
<body>
  <header>
    <img src="img/logo-metabuscador.png" alt="Logo TuneMyTrip" loading="lazy" />
  </header>
  <main>
    <h1>Resultados de tu búsqueda</h1>
    <div id="results-container" aria-live="polite"></div>
    <div style="text-align:center;">
      <a href="index.html" class="back-link" onclick="localStorage.clear()">↶ Nueva búsqueda</a>
    </div>
  </main>
  <script>
    function formatDateTime(dtStr) {
      if (!dtStr) return '-';
      const dt = new Date(dtStr);
      return isNaN(dt) ? dtStr : dt.toLocaleString('es-ES', {dateStyle:'short', timeStyle:'short'});
    }
    const resultsContainer = document.getElementById('results-container');
    const hotelJson = localStorage.getItem('hotelResults');
    const vueloJson = localStorage.getItem('flightResults');
    if (!hotelJson && !vueloJson) {
      resultsContainer.innerHTML = '<p class="empty-result">No hay resultados recientes.<br>Por favor, realiza una nueva búsqueda.</p>';
      setTimeout(()=>{window.location.href="index.html"}, 1700);
    } else {
      let html = "";
      let hotelData = [];
      try { hotelData = hotelJson ? JSON.parse(hotelJson) : []; } catch {}
      if(hotelData.length>0){
        html += `<div class="section-title">Hoteles disponibles</div>`;
        html += hotelData.map(hotel=>`
          <div class="result-item">
            <strong>${hotel.name||'-'}</strong><br>
            Categoría: ${hotel.stars ? hotel.stars+' estrellas':'-'}<br>
            Dirección: ${hotel.address||'-'}<br>
            Precio estimado: ${hotel.price? hotel.price+' USD':'-'}
          </div>
        `).join('');
      }
      let vueloData = [];
      try { vueloData = vueloJson ? JSON.parse(vueloJson): [];} catch{}
      if(vueloData.length > 0){
        html += `<div class="section-title">Vuelos encontrados</div>`;
        html += vueloData.map(flight=>`
          <div class="result-item">
            <strong>${(flight.airline && flight.airline.name) || '-'} - Vuelo ${(flight.flight && flight.flight.number) || '-'}</strong><br>
            Salida: ${(flight.departure && flight.departure.airport) || '-'} a las ${formatDateTime(flight.departure && flight.departure.scheduled)}<br>
            Llegada: ${(flight.arrival && flight.arrival.airport) || '-'} a las ${formatDateTime(flight.arrival && flight.arrival.scheduled)}<br>
            Estado: ${flight.flight_status || '-'}
          </div>
        `).join('');
      }
      if(!html)
        html = `<p class="empty-result">No se encontraron resultados con tu búsqueda.<br>Por favor, intenta nuevamente.</p>`;
      resultsContainer.innerHTML = html;
    }
  </script>
</body>
</html>
